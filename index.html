<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aimly - focus made simple</title>
    <link rel="stylesheet" href="./styles/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@1,500;1,700&display=swap"
        rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
</head>

<body>
    <header class="header">
        <div class="header-top">
            <div class="cursor-icon">
                <h1 class="site-title">aim.ly</h1>
                <div class="cursor-dots">
                    <div class="dot dot-purple"></div>
                    <div class="dot dot-pink"></div>
                    <div class="dot dot-pink"></div>
                    <div class="dot dot-purple"></div>
                </div>
            </div>
            <button class="language-toggle" data-lang="pt">
                <img src="assets/brazil_flag.svg" class="flag flag-br" alt="Mudar para PortuguÃªs">
                <img src="assets/uk_flag.svg" class="flag flag-us" alt="Switch to English">
            </button>
        </div>
        <div class="quote-container">
            <p class="quote-text"></p>
            <p class="quote-author"></p>
        </div>
    </header>
    <div class="pomodoro-section">
        <div class="pomodoro-container">
            <div class="timer-display">
                <span class="time">25:00</span>
                <div class="timer-mode">work</div>
            </div>
            <div class="timer-controls">
                <button class="timer-btn start-btn">Start</button>
                <button class="timer-btn reset-btn">Reset</button>
            </div>
            <div class="timer-modes">
                <button class="mode-btn work-btn active">Work</button>
                <button class="mode-btn short-break-btn">Break</button>
                <button class="mode-btn long-break-btn">Long Break</button>
            </div>
        </div>
    </div>
    <div class="task-board">
        <div class="task-input-container">
            <input type="text" class="task-input" placeholder="Adicionar nova tarefa...">
            <button class="add-task-btn">Adicionar</button>
        </div>

        <div class="task-list">
            <!-- As tasks serÃ£o adicionadas aqui dinamicamente -->
        </div>
    </div>
    <footer class="footer">
        <p class="made-with-love">
            Made with <span class="heart">ðŸ’œ</span> by
            <a class="footer-link" href="https://www.linkedin.com/in/oguisaraiva/" target="_blank" rel="noopener noreferrer">
                @oguisaraiva
            </a>
        </p>
    </footer>

    <div class="modal" id="dateModal">
        <div class="modal-content">
            <h3>Selecionar Data</h3>
            <input type="date" id="taskDate" class="date-input">
            <div class="modal-buttons">
                <button class="modal-btn cancel-btn">Cancelar</button>
                <button class="modal-btn confirm-btn">Confirmar</button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'preferredLanguage';
        const DEFAULT_LANG = 'pt';

        const quotes = {
            pt: [
                {
                    text: "A disciplina Ã© a ponte entre metas e realizaÃ§Ãµes.",
                    author: "Jim Rohn"
                },
                {
                    text: "NÃ£o Ã© o tempo que passa, Ã© vocÃª que passa por ele.",
                    author: "AristÃ³teles"
                },
                {
                    text: "O segredo para seguir em frente Ã© comeÃ§ar.",
                    author: "Mark Twain"
                },
                {
                    text: "A persistÃªncia Ã© o caminho do Ãªxito.",
                    author: "Charles Chaplin"
                },
                {
                    text: "Conhecimento nÃ£o Ã© aquilo que vocÃª sabe, mas o que vocÃª faz com aquilo que sabe.",
                    author: "Aldous Huxley"
                }
            ],
            en: [
                {
                    text: "Discipline is the bridge between goals and accomplishment.",
                    author: "Jim Rohn"
                },
                {
                    text: "Time doesn't pass, you pass through it.",
                    author: "Aristotle"
                },
                {
                    text: "The secret of getting ahead is getting started.",
                    author: "Mark Twain"
                },
                {
                    text: "Persistence is the path to success.",
                    author: "Charles Chaplin"
                },
                {
                    text: "Knowledge is not what you know, but what you do with what you know.",
                    author: "Aldous Huxley"
                }
            ]
        };

        function updateQuote(lang) {
            const quoteText = document.querySelector('.quote-text');
            const quoteAuthor = document.querySelector('.quote-author');

            // Seleciona uma quote aleatÃ³ria
            const randomIndex = Math.floor(Math.random() * quotes[lang].length);
            const selectedQuote = quotes[lang][randomIndex];

            // Remove as classes de animaÃ§Ã£o
            quoteText.style.animation = 'none';
            quoteAuthor.style.animation = 'none';

            // ForÃ§a um reflow
            void quoteText.offsetWidth;
            void quoteAuthor.offsetWidth;

            // Reaplica as animaÃ§Ãµes
            quoteText.style.animation = 'slideUpFade 0.6s ease forwards';
            quoteAuthor.style.animation = 'slideUpFade 0.6s ease forwards 0.2s';

            // Atualiza o conteÃºdo
            quoteText.textContent = `"${selectedQuote.text}"`;
            quoteAuthor.textContent = `- ${selectedQuote.author}`;

            setTimeout(() => {
                quoteText.textContent = `"${selectedQuote.text}"`;
                quoteAuthor.textContent = `- ${selectedQuote.author}`;

                quoteText.style.opacity = '1';
                quoteAuthor.style.opacity = '1';
            }, 300);
        }

        const translations = {
            pt: {
                placeholder: 'Meu objetivo hoje Ã©...',
                addButton: 'Adicionar',
                selectDate: 'Selecionar Data',
                confirm: 'Confirmar',
                cancel: 'Cancelar',
            },
            en: {
                placeholder: 'My goal today is...',
                addButton: 'Add',
                selectDate: 'Select Date',
                confirm: 'Confirm',
                cancel: 'Cancel'
            }
        };

        function updateTexts(lang) {
            document.querySelector('.task-input').placeholder = translations[lang].placeholder;
            document.querySelector('.add-task-btn').textContent = translations[lang].addButton;
            document.querySelector('#dateModal h3').textContent = translations[lang].selectDate;
            document.querySelector('#dateModal .confirm-btn').textContent = translations[lang].confirm;
            document.querySelector('#dateModal .cancel-btn').textContent = translations[lang].cancel;
        }

        function applyLanguage(lang) {
            const langButton = document.querySelector('.language-toggle');
            langButton.dataset.lang = lang;
            updateTexts(lang);
            updateQuote(lang);
            localStorage.setItem(STORAGE_KEY, lang);
        }

        function toggleLanguage() {
            const langButton = document.querySelector('.language-toggle');
            const currentLang = langButton.dataset.lang;
            const newLang = currentLang === 'pt' ? 'en' : 'pt';
            applyLanguage(newLang);
        }

        // InicializaÃ§Ã£o do language toggle
        document.addEventListener('DOMContentLoaded', () => {
            const langButton = document.querySelector('.language-toggle');
            langButton.addEventListener('click', toggleLanguage);

            const preferredLanguage = localStorage.getItem(STORAGE_KEY) || DEFAULT_LANG;
            applyLanguage(preferredLanguage);
        });

        // Pomodoro Timer

        class PomodoroTimer {
            constructor() {
                this.timeLeft = 25 * 60;
                this.isRunning = false;
                this.timerInterval = null;
                this.mode = 'work';
                this.cycles = 0;

                this.times = {
                    work: 25 * 60,
                    shortBreak: 5 * 60,
                    longBreak: 15 * 60
                };

                this.initializeElements();
                this.setupEventListeners();
            }

            initializeElements() {
                this.timeDisplay = document.querySelector('.time');
                this.modeDisplay = document.querySelector('.timer-mode');
                this.startBtn = document.querySelector('.start-btn');
                this.resetBtn = document.querySelector('.reset-btn');
                this.modeButtons = document.querySelectorAll('.mode-btn');
            }

            setupEventListeners() {
                this.startBtn.addEventListener('click', () => this.toggleTimer());
                this.resetBtn.addEventListener('click', () => this.resetTimer());

                this.modeButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => this.changeMode(e.target));
                });
            }

            toggleTimer() {
                if (this.isRunning) {
                    this.pauseTimer();
                } else {
                    this.startTimer();
                }
            }

            startTimer() {
                this.isRunning = true;
                this.startBtn.textContent = 'Pause';

                this.timerInterval = setInterval(() => {
                    this.timeLeft--;
                    this.updateDisplay();

                    if (this.timeLeft === 0) {
                        this.handleTimerComplete();
                    }
                }, 1000);
            }

            pauseTimer() {
                this.isRunning = false;
                this.startBtn.textContent = 'Start';
                clearInterval(this.timerInterval);
            }

            resetTimer() {
                this.pauseTimer();
                this.timeLeft = this.times[this.mode];
                this.updateDisplay();
            }

            updateDisplay() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                this.timeDisplay.textContent =
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            changeMode(button) {
                const modes = {
                    'work-btn': 'work',
                    'short-break-btn': 'shortBreak',
                    'long-break-btn': 'longBreak'
                };

                this.mode = modes[button.className.split(' ')[1]];
                this.timeLeft = this.times[this.mode];
                this.modeDisplay.textContent = this.mode.replace(/([A-Z])/g, ' $1').toLowerCase();

                this.modeButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                this.resetTimer();
            }

            handleTimerComplete() {
                this.pauseTimer();
                this.playNotification();

                if (this.mode === 'work') {
                    this.cycles++;
                    if (this.cycles % 4 === 0) {
                        document.querySelector('.long-break-btn').click();
                    } else {
                        document.querySelector('.short-break-btn').click();
                    }
                } else {
                    document.querySelector('.work-btn').click();
                }
            }

            playNotification() {
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification('Timer Complete!', {
                        body: `${this.mode} session completed!`
                    });
                }
            }
        }

        // InicializaÃ§Ã£o
        document.addEventListener('DOMContentLoaded', () => {
            const langButton = document.querySelector('.language-toggle');
            langButton.addEventListener('click', toggleLanguage);

            // Carrega o idioma preferido do usuÃ¡rio ou usa PT como padrÃ£o
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'pt';
            applyLanguage(preferredLanguage);

            const taskInput = document.querySelector('.task-input');
            const addTaskBtn = document.querySelector('.add-task-btn');
            const taskList = document.querySelector('.task-list');
            const taskBoard = document.querySelector('.task-board');
            const pomodoroSection = document.querySelector('.pomodoro-section');
            const modal = document.getElementById('dateModal');
            const dateInput = document.getElementById('taskDate');
            const cancelBtn = modal.querySelector('.cancel-btn');
            const confirmBtn = modal.querySelector('.confirm-btn');

            let currentTaskItem = null;
            let currentDateElement = null;

            // ConfiguraÃ§Ã£o dos listeners do modal
            confirmBtn.addEventListener('click', () => {
                if (currentTaskItem && currentDateElement) {
                    const selectedDate = dateInput.value;
                    if (selectedDate) {
                        const date = new Date(selectedDate + 'T12:00:00');
                        currentTaskItem.dataset.dueDate = date.toISOString();

                        const formattedDate = date.toLocaleDateString('pt-BR', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric'
                        });

                        currentDateElement.textContent = formattedDate;
                        currentDateElement.classList.add('date-added');
                    }
                    modal.classList.remove('show');
                    saveTasks();
                }
            });

            cancelBtn.addEventListener('click', () => {
                modal.classList.remove('show');
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('show');
                }
            });

            function showDateModal(taskItem, dateElement) {
                currentTaskItem = taskItem;
                currentDateElement = dateElement;
                modal.classList.add('show');

                if (taskItem.dataset.dueDate) {
                    const date = new Date(taskItem.dataset.dueDate);
                    date.setMinutes(date.getMinutes() + date.getTimezoneOffset());
                    dateInput.value = date.toISOString().split('T')[0];
                } else {
                    dateInput.value = '';
                }
            }

            pomodoroSection.classList.add('fade-in');
            taskBoard.classList.add('fade-in');

            function loadTasks() {
                const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                taskList.innerHTML = ''; // Limpa a lista antes de carregar

                tasks.forEach(task => {
                    const taskElement = createTask(
                        task.text,
                        task.id,
                        task.completed,
                        task.dueDate
                    );

                    // Se houver uma data, atualiza o elemento visual
                    if (task.dueDate) {
                        const dateElement = taskElement.querySelector('.task-date');
                        const date = new Date(task.dueDate);
                        const formattedDate = date.toLocaleDateString('pt-BR', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric'
                        });
                        dateElement.textContent = formattedDate;
                        dateElement.classList.add('date-added');
                    }

                    taskList.appendChild(taskElement);
                    taskElement.classList.add('slide-in');
                });
            }

            function saveTasks() {
                const tasks = Array.from(taskList.children).map(taskElement => ({
                    id: taskElement.dataset.taskId,
                    text: taskElement.querySelector('.task-text').textContent,
                    completed: taskElement.querySelector('input[type="checkbox"]').checked,
                    dueDate: taskElement.dataset.dueDate
                }));
                localStorage.setItem('tasks', JSON.stringify(tasks));
            }

            function createTask(taskText, taskId = Date.now().toString(), completed = false, dueDate = null) {
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.dataset.taskId = taskId;
                taskItem.dataset.dueDate = dueDate;

                // Checkbox container
                const checkboxContainer = document.createElement('div');
                checkboxContainer.className = 'checkbox-container';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `task-${taskId}`;
                checkbox.checked = completed;

                const label = document.createElement('label');
                label.className = 'checkbox-label';
                label.htmlFor = checkbox.id;

                const confettiContainer = document.createElement('div');
                confettiContainer.className = 'confetti';

                if (completed) {
                    label.textContent = "âœ“";
                    taskItem.classList.add('task-completed');
                }

                checkbox.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        label.textContent = "âœ“";
                        createConfetti(confettiContainer);
                        taskItem.classList.add('task-completed');
                    } else {
                        label.textContent = "";
                        taskItem.classList.remove('task-completed');
                    }
                    saveTasks();
                });

                // Anexar elementos do checkbox
                checkboxContainer.appendChild(checkbox);
                checkboxContainer.appendChild(label);
                checkboxContainer.appendChild(confettiContainer);

                // Task content
                const taskContent = document.createElement('div');
                taskContent.className = 'task-content';

                const taskTextElement = document.createElement('p');
                taskTextElement.className = 'task-text';
                taskTextElement.textContent = taskText;

                const dateElement = document.createElement('span');
                dateElement.className = 'task-date';
                if (dueDate) {
                    const date = new Date(dueDate);
                    const formattedDate = date.toLocaleDateString('pt-BR', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric'
                    });
                    dateElement.textContent = formattedDate;
                    dateElement.classList.add('date-added');
                }

                taskContent.appendChild(taskTextElement);
                taskContent.appendChild(dateElement);

                // Actions container
                const actionsContainer = document.createElement('div');
                actionsContainer.className = 'task-actions';

                // Date and Delete buttons
                const dateBtn = document.createElement('button');
                dateBtn.className = 'date-btn';
                dateBtn.innerHTML = `
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                        <path d="M19 4h-1V3c0-.55-.45-1-1-1s-1 .45-1 1v1H8V3c0-.55-.45-1-1-1s-1 .45-1 1v1H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z" fill="currentColor"/>
                    </svg>
                `;

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerHTML = `
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" fill="currentColor"/>
                    </svg>
                `;

                // Event listeners
                dateBtn.addEventListener('click', () => {
                    showDateModal(taskItem, dateElement);
                });

                deleteBtn.addEventListener('click', () => {
                    taskItem.classList.add('fade-out');
                    setTimeout(() => {
                        taskItem.remove();
                        saveTasks();
                    }, 300);
                });

                actionsContainer.appendChild(dateBtn);
                actionsContainer.appendChild(deleteBtn);

                // Anexar todos os elementos ao taskItem na ordem correta
                taskItem.appendChild(checkboxContainer);
                taskItem.appendChild(taskContent);
                taskItem.appendChild(actionsContainer);

                return taskItem;
            }

            function createConfetti(container) {
                container.innerHTML = "";

                for (let i = 0; i < 30; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti-piece');

                    // Cores aleatÃ³rias para o confetti
                    const colors = ['#ffd700', '#ff3e00', '#00ff00', '#00ffff', '#ff00ff'];
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                    // CÃ¡lculo da dispersÃ£o em 360 graus
                    const angle = Math.random() * Math.PI * 2; // Ã‚ngulo completo (360 graus)
                    const spread = 20 + Math.random() * 60; // Ajustando a distÃ¢ncia da dispersÃ£o

                    // Calculando posiÃ§Ãµes finais usando seno e cosseno para movimento circular
                    const endX = Math.cos(angle) * spread;
                    const endY = Math.sin(angle) * spread;

                    confetti.style.setProperty('--end-x', `${endX}px`);
                    confetti.style.setProperty('--end-y', `${endY}px`);

                    // Variando velocidades e delays para movimento mais natural
                    confetti.style.animationDelay = `${Math.random() * 0.2}s`;
                    confetti.style.animationDuration = `${0.8 + Math.random() * 0.4}s`;

                    // RotaÃ§Ã£o aleatÃ³ria para cada peÃ§a
                    confetti.style.setProperty('--rotation', `${Math.random() * 720 - 360}deg`);

                    container.appendChild(confetti);
                }
            }

            addTaskBtn.addEventListener('click', () => {
                const taskText = taskInput.value.trim();
                if (taskText) {
                    const taskElement = createTask(taskText);
                    taskList.appendChild(taskElement);
                    taskInput.value = '';
                    saveTasks();
                }
            });

            taskInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addTaskBtn.click();
                }
            });

            // Carrega as tasks ao iniciar
            loadTasks();
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Suas inicializaÃ§Ãµes existentes

            // Inicializar o Pomodoro
            const pomodoro = new PomodoroTimer();

            // Solicitar permissÃ£o para notificaÃ§Ãµes
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        });
    </script>
</body>

</html>